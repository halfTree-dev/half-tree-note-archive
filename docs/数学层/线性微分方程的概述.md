# 线性微分方程的概述

我们称像这样

$$
y^{(n)} + p_{1}(x)y^{(n-1)} + p_{2}(x)y^{(n-2)} + \cdots + p_{n}(x)y = f(x)
$$

的关于未知函数和各阶导数均为一次的微分方程为线性微分方程。

其中，若 $f(x) \equiv 0$，则称为齐次线性微分方程；否则称为非齐次线性微分方程。

## 齐次线性微分方程解的结构

### 解的叠加性质

对于一个 $n$ 阶线性微分方程，如果 $y_{1}(x)$ 和 $y_{2}(x)$ 是方程的两个解，则它们的线性组合 $y = C_{1}y_{1}(x) + C_{2}y_{2}(x)$ 也是方程的解。

!!! proof "证明线性微分方程解的叠加性"
    假设 $y_{1}(x)$ 和 $y_{2}(x)$ 是齐次线性微分方程的解

    $$
    y^{(n)} + p_{1}(x)y^{(n-1)} + p_{2}(x)y^{(n-2)} + \cdots + p_{n}(x)y = 0
    $$

    那么

    $$
    \begin{aligned}
    y_{1}^{(n)} + p_{1}(x)y_{1}^{(n-1)} + p_{2}(x)y_{1}^{(n-2)} + \cdots + p_{n}(x)y_{1} &= 0 \\
    y_{2}^{(n)} + p_{1}(x)y_{2}^{(n-1)} + p_{2}(x)y_{2}^{(n-2)} + \cdots + p_{n}(x)y_{2} &= 0
    \end{aligned}
    $$

    现在考虑线性组合 $y = C_{1}y_{1}(x) + C_{2}y_{2}(x)$，将其代入原方程

    $$
    \begin{aligned}
    y^{(n)} &+ p_{1}(x)y^{(n-1)} + p_{2}(x)y^{(n-2)} + \cdots + p_{n}(x)y \\
    &= (C_{1}y_{1}(x) + C_{2}y_{2}(x))^{(n)} + p_{1}(x)(C_{1}y_{1}(x) + C_{2}y_{2}(x))^{(n-1)} + \cdots + p_{n}(x)(C_{1}y_{1}(x) + C_{2}y_{2}(x)) \\
    &= C_{1}y_{1}^{(n)} + C_{2}y_{2}^{(n)} + p_{1}(x)(C_{1}y_{1}^{(n-1)} + C_{2}y_{2}^{(n-1)}) + \cdots + p_{n}(x)(C_{1}y_{1} + C_{2}y_{2}) \\
    &= C_{1}(y_{1}^{(n)} + p_{1}(x)y_{1}^{(n-1)} + \cdots + p_{n}(x)y_{1}) + C_{2}(y_{2}^{(n)} + p_{1}(x)y_{2}^{(n-1)} + \cdots + p_{n}(x)y_{2}) \\
    &= C_{1} \cdot 0 + C_{2} \cdot 0 = 0
    \end{aligned}
    $$

    因此，线性组合 $y = C_{1}y_{1}(x) + C_{2}y_{2}(x)$ 也是原方程的解。

### 解空间的维数和 Wronskian 行列式

接下来介绍一个重要的推论：对于一个 $n$ 阶线性微分方程，齐次线性微分方程有 $n$ 个线性无关的解 $y_{1}(x), y_{2}(x), \cdots, y_{n}(x)$。

!!! note "关于线性无关"
    线性无关是指对于方程

    $$
    C_{1}y_{1}(x) + C_{2}y_{2}(x) + \cdots + C_{n}y_{n}(x) = 0
    $$

    当方程仅存在唯一解 $C_{1} = C_{2} = \cdots = C_{n} = 0$ 时，称 $y_{1}(x), y_{2}(x), \cdots, y_{n}(x)$ 线性无关。

    线性无关相当于一个函数不能由其他函数线性组合而成，即无法通过初等变换相互表示。

我们在此基础上引入 Wronskian（朗斯基）行列式的概念，对于 $n$ 个函数 $y_1(x), y_2(x), \cdots, y_n(x)$，它们的 Wronskian 行列式定义为：

$$
W(y_1, y_2, \cdots, y_n) = 
\begin{vmatrix} 
y_1 & y_2 & \cdots & y_n \\
y_1' & y_2' & \cdots & y_n' \\
\vdots & \vdots & \ddots & \vdots \\
y_1^{(n-1)} & y_2^{(n-1)} & \cdots & y_n^{(n-1)}
\end{vmatrix}
$$

对于定义在 $x \in [a, b]$ 上的 $y_{1}, y_{2}, \cdots, y_{n}$ 如果在区间内的某点 $x_0$ 处，Wronskian 行列式不为零，则这 $n$ 个函数在该区间是线性无关的。

!!! proof "Wronskian 行列式与函数线性无关性"
    我们可以证明其逆否命题：如果 $n$ 个函数 $y_1, y_2, \cdots, y_n$ 在区间 $[a, b]$ 上线性相关，则这些函数的 Wronskian 行列式 $W(y_1, y_2, \cdots, y_n)$ 在整个区间上恒等于零。

    若 $y_1, y_2, \cdots, y_n$ 线性相关，则存在不全为零的常数 $C_1, C_2, \cdots, C_n$，使得

    $$C_1 y_1(x) + C_2 y_2(x) + \cdots + C_n y_n(x) = 0, \quad \forall x \in [a, b]$$

    对上式求导，得到

    $$C_1 y_1'(x) + C_2 y_2'(x) + \cdots + C_n y_n'(x) = 0$$

    继续求导直到 $(n-1)$ 阶导数

    $$C_1 y_1^{(n-1)}(x) + C_2 y_2^{(n-1)}(x) + \cdots + C_n y_n^{(n-1)}(x) = 0$$

    上述 $n$ 个方程构成了一个关于 $C_1, C_2, \cdots, C_n$ 的齐次线性方程组。不难看出下方的这个行列式构成方程组即为上方所述方程组，且其存在一组非零解 $(C_1, C_2, \cdots, C_n)$。

    $$
    \begin{bmatrix}
    y_1 & y_2 & \cdots & y_n \\
    y_1' & y_2' & \cdots & y_n' \\
    \vdots & \vdots & \ddots & \vdots \\
    y_1^{(n-1)} & y_2^{(n-1)} & \cdots & y_n^{(n-1)}
    \end{bmatrix} \cdot
    \begin{bmatrix}
    C_{1} \\
    C_{2} \\
    \vdots \\
    C_{n}
    \end{bmatrix} = 0
    $$

    这说明 Wronskian 行列式 $W(y_1, y_2, \cdots, y_n) = 0$。

    因此，如果 Wronskian 行列式在某点 $x_0$ 不为零，根据逆否命题，函数 $y_1, y_2, \cdots, y_n$ 在区间上必定线性无关。

上述的条件还不够强，因为其逆命题：函数在区间上线性无关 $\Rightarrow$ Wronskian 行列式在区间存在某点不为零，并不成立。

!!! note "函数在区间上线性无关 $\nRightarrow$ Wronskian 行列式在区间存在某点不为零的例子"
    $$
    y_1(x) = |x^3|
    $$

    $$
    y_2(x) = x^3
    $$

不过，如果我们加上一个条件：$y_{1}, y_{2}, \cdots, y_{n}$ 是一组 $n$ 阶齐次线性微分方程的解，就可以把它们变为等价的了。

!!! proof "齐次线性微分方程解的线性无关性与 Wronskian 行列式存在非零点的等价性"
    我们已经证明了如果Wronskian不为零，则函数线性无关。现在证明反方向的命题：如果 $y_1, y_2, \cdots, y_n$ 是n阶齐次线性微分方程的线性无关解，则它们的Wronskian行列式 $W(y_1, y_2, \cdots, y_n)(x) \neq 0$，$\forall x \in [a, b]$。

    采用反证法：假设存在某点 $x_0 \in [a, b]$，使得 $W(y_1, y_2, \cdots, y_n)(x_0) = 0$，那么

    $$
    \begin{cases}
    C_1 y_1(x_0) + C_2 y_2(x_0) + \cdots + C_n y_n(x_0) = 0 \\
    C_1 y_1'(x_0) + C_2 y_2'(x_0) + \cdots + C_n y_n'(x_0) = 0 \\
    \vdots \\
    C_1 y_1^{(n-1)}(x_0) + C_2 y_2^{(n-1)}(x_0) + \cdots + C_n y_n^{(n-1)}(x_0) = 0
    \end{cases}
    $$

    存在非零解 $(C_1, C_2, \cdots, C_n)$，那么

    现在构造函数 $\phi(x) = C_1 y_1(x) + C_2 y_2(x) + \cdots + C_n y_n(x)$。由于 $y_1, y_2, \cdots, y_n$ 都是齐次线性微分方程的解，$\phi(x)$ 也是该方程的解。

    根据上述方程组，我们有
    $$
    \phi(x_0) = \phi'(x_0) = \cdots = \phi^{(n-1)}(x_0) = 0
    $$

    这意味着 $\phi(x)$ 满足初始条件 $\phi(x_0) = \phi'(x_0) = \cdots = \phi^{(n-1)}(x_0) = 0$。根据微分方程的唯一性定理，满足这一初始条件的解只有零解 $\phi(x) \equiv 0$。

    因此，$C_1 y_1(x) + C_2 y_2(x) + \cdots + C_n y_n(x) \equiv 0$，方程存在非全 $0$ 解，这与 $y_1, y_2, \cdots, y_n$ 线性无关的假设矛盾。

    所以，假设不成立，对于 $n$ 阶齐次线性微分方程的线性无关解，其 Wronskian 行列式在整个区间上都不为零。

根据齐次线性微分方程解的线性无关 $\Leftrightarrow$ Wronskian 行列式存在非零点，我们可以知道，一个 $n$ 阶齐次线性微分方程的解空间是 $n$ 维的，即其必然存在 $n$ 个线性无关的解。

!!! proof "证明 $n$ 阶齐次线性微分方程解空间的维数为 $n$"
    考虑 $n$ 阶齐次线性微分方程

    $$
    y^{(n)} + p_{1}(x)y^{(n-1)} + p_{2}(x)y^{(n-2)} + \cdots + p_{n}(x)y = 0
    $$

    为了凑出 $n$ 个线性无关的基底，我们选取 $n$ 组不同的初始条件，对第 $i$ 组初始条件 $(i = 1,2,\ldots,n)$，在点 $x_0$ 处有
    $$
    y^{(j-1)}(x_0) = \delta_{ij} = \begin{cases}
    1, & j = i \\
    0, & j \neq i
    \end{cases}, \quad j = 1,2,\ldots,n
    $$

    根据微分方程解的存在唯一性定理，对每组初始条件，方程存在唯一解 $y_i(x)$。

    现在证明这 $n$ 个解是线性无关的。计算它们在 $x_0$ 处的 Wronskian 行列式：

    $$
    W(y_1, y_2, \cdots, y_n)(x_0) = 
    \begin{vmatrix} 
    y_1(x_0) & y_2(x_0) & \cdots & y_n(x_0) \\
    y_1'(x_0) & y_2'(x_0) & \cdots & y_n'(x_0) \\
    \vdots & \vdots & \ddots & \vdots \\
    y_1^{(n-1)}(x_0) & y_2^{(n-1)}(x_0) & \cdots & y_n^{(n-1)}(x_0)
    \end{vmatrix}
    $$

    根据我们的初始条件设置，这个行列式实际上是一个单位矩阵的行列式，因此

    $$
    W(y_1, y_2, \cdots, y_n)(x_0) = |E| = 1 \neq 0
    $$

    所以这 $n$ 个解是线性无关的，即它们张成的解空间的维数为 $n$。

真是不容易啊，不过我们好在得出了结论：$n$ 阶齐次线性微分方程的解是具有可加性和数乘性的，且包含 $n$ 个线性无关的解。

## 非齐次线性微分方程解的结构
对于一个 $n$ 阶非齐次线性微分方程

$$
y^{(n)} + p_{1}(x)y^{(n-1)} + p_{2}(x)y^{(n-2)} + \cdots + p_{n}(x)y = f(x)
$$

它的通解结构是其对应的齐次线性微分方程的通解加上一个特解，即

$$
y(x) = y_h(x) + y_p(x)
$$

其中 $y_h(x)$ 是齐次线性微分方程 $y^{(n)} + p_{1}(x)y^{(n-1)} + p_{2}(x)y^{(n-2)} + \cdots + p_{n}(x)y = 0$ 的通解，$y_p(x)$ 是该非齐次线性微分方程的一个特解。

!!! proof "证明非齐次线性微分方程解的结构"
    首先，我们证明如果 $y_1(x)$ 和 $y_2(x)$ 都是非齐次线性微分方程的解，那么它们的差 $y_1(x) - y_2(x)$ 是对应齐次线性微分方程的解。

    对于非齐次线性微分方程

    $$
    y^{(n)} + p_{1}(x)y^{(n-1)} + p_{2}(x)y^{(n-2)} + \cdots + p_{n}(x)y = f(x)
    $$

    如果 $y_1(x)$ 和 $y_2(x)$ 都是其解，则有

    $$
    \begin{aligned}
    y_1^{(n)} + p_{1}(x)y_1^{(n-1)} + p_{2}(x)y_1^{(n-2)} + \cdots + p_{n}(x)y_1 &= f(x) \\
    y_2^{(n)} + p_{1}(x)y_2^{(n-1)} + p_{2}(x)y_2^{(n-2)} + \cdots + p_{n}(x)y_2 &= f(x)
    \end{aligned}
    $$

    相减得

    $$
    (y_1 - y_2)^{(n)} + p_{1}(x)(y_1 - y_2)^{(n-1)} + \cdots + p_{n}(x)(y_1 - y_2) = 0
    $$

    因此，$y_1(x) - y_2(x)$ 是对应齐次线性微分方程的解。所以对于 $y_p(x)$ 是非齐次线性微分方程的一个特解，$y(x)$ 是该方程的任意解。根据上面的证明，$y(x) - y_p(x)$ 是对应齐次线性微分方程的解，即存在常数 $C_1, C_2, \cdots, C_n$ 使得

    $$
    y(x) - y_p(x) = C_1 y_1(x) + C_2 y_2(x) + \cdots + C_n y_n(x)
    $$

    其中 $y_1(x), y_2(x), \cdots, y_n(x)$ 是齐次线性微分方程的 $n$ 个线性无关解。

    因此

    $$
    y(x) = y_p(x) + C_1 y_1(x) + C_2 y_2(x) + \cdots + C_n y_n(x) = y_p(x) + y_h(x)
    $$

    其中 $y_h(x) = C_1 y_1(x) + C_2 y_2(x) + \cdots + C_n y_n(x)$ 是齐次线性微分方程的通解。

    所以，非齐次线性微分方程的通解可以表示为其对应齐次线性微分方程的通解加上一个特解。

## 常系数齐次线性微分方程

### 二阶常系数齐次线性微分方程

不幸的是，线性微分方程并没有通用的求通解和特解的方法，So Bad！不过对于一些特殊形式的线性微分方程，我们可以通过一些特殊方法来求解它们的通解和特解。

先从简单的例子开始讨论，形如

$$
y'' + a_1 y' + a_2 y = 0
$$

其中 $a_1, a_2$ 是常数的方程，我们称之为二阶常系数齐次线性微分方程。

解这类方程，我们可以先猜测其解的形式为 $y = e^{rx}$，其中 $r$ 是待定常数。将其代入原方程，得到

$$
r^2 e^{rx} + a_1 r e^{rx} + a_2 e^{rx} = 0
$$

由于 $e^{rx} \neq 0$，所以上式等价于

$$
r^2 + a_1 r + a_2 = 0
$$

这个二次方程称为原微分方程的特征方程，其根称为特征根。根据两个特征根的情况，我们可以求出该微分方程的两个线性无关解，接下来分类讨论

1. **特征根为实数且不相等**：设特征根为 $r_1, r_2$，则很容易发现

    $$
    y_1(x) = e^{r_1 x}, \quad y_2(x) = e^{r_2 x}
    $$

    是原方程的两个线性无关解，因此原方程的通解为

    $$
    y(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x}
    $$

2. **特征根为实数且相等**：设特征根为 $r$，则原方程有一个根 $y_1(x) = e^{rx}$，但是出于解只有一个，我们还要找到另一个线性无关根。
    不妨设 $y_2(x) = u(x) e^{rx}$，将其带入原方程有

    $$
    u'' + (2r + a_1) u' + (r^2 + a_1 r + a_2) u = 0
    $$

    出于 $r$ 是特征根，所以上式的系数 $r^2 + a_1 r + a_2 = 0$ 且 $2r + a_1 = 0$，因此我们可以将其化为

    $$
    u'' = 0
    $$

    $u(x)$ 仅需满足 $u'' = 0$，不妨设 $u(x) = x$，那么 $y_2(x) = x e^{rx}$，与 $y_1(x)$ 线性无关，因此原方程的通解为
    $$
    y(x) = C_1 e^{rx} + C_2 x e^{rx}
    $$

3. **特征根为复数**：设特征根为 $r_1 = \alpha + \beta i, r_2 = \alpha - \beta i$，则通过欧拉公式和三角变换，得出原方程的通解为

    $$
    y(x) = e^{\alpha x} (C_1 \cos(\beta x) + C_2 \sin(\beta x))
    $$

### N 阶情况的推广

这便是求解二阶常系数齐次线性微分方程的通解的方法，实际上，这个方法可以推广到 $n$ 阶常系数齐次线性微分方程。

对于 $n$ 阶常系数齐次线性微分方程

$$
y^{(n)} + a_{n-1} y^{(n-1)} + a_{n-2} y^{(n-2)} + \cdots + a_1 y' + a_0 y = 0
$$

1. 先求出其特征方程
    $$
    r^n + a_{n-1} r^{n-1} + a_{n-2} r^{n-2} + \cdots + a_1 r + a_0 = 0
    $$

2. 求出 $n$ 个特征根 $r_1, r_2, \cdots, r_n$

3. 根据特征根的情况，做以下分类讨论处理
    1. **特征根都为实数且都不相等**：太好了，设特征根为 $r_1, r_2, \cdots, r_n$，则原方程的通解为

        $$
        y(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x} + \cdots + C_n e^{r_n x}
        $$

    2. **有 $k$ 重实根**：设特征根为 $r$，则原方程有一个根 $y_1(x) = e^{rx}$，但是出于解只有一个，我们还要找到其他线性无关根。
        不妨设 $y_k(x) = u_k(x) e^{rx}$，将其带入原方程有

        $$
        u_k^{(n)} + (nr + a_{n-1}) u_k^{(n-1)} + (nr(n-1) + a_{n-2}) u_k^{(n-2)} + \cdots + (nr^2 + a_1) u_k' + (nr^k + a_0) u_k = 0
        $$

        出于 $r$ 是特征根，所以上式的系数 $nr^k + a_k = 0$，因此我们可以将其化为

        $$
        u_k^{(n)} = 0
        $$

        $u_k(x)$ 仅需满足 $u_k^{(n)} = 0$，不妨设 $u_k(x) = x^k$，那么 $y_k(x) = x^k e^{rx}$，与其他 $y_i(x)$ 线性无关，因此原方程的通解为
        $$
        y(x) = C_1 e^{rx} + C_2 x e^{rx} + \cdots + C_n x^{n-1} e^{rx}
        $$

    3. **有一对单复根**：设特征根为 $r_1 = \alpha + \beta i$，$r_2 = \alpha - \beta i$，则通过欧拉公式和三角变换，得出原方程的通解为

        $$
        y(x) = e^{\alpha x} (C_1 \cos(\beta x) + C_2 \sin(\beta x))
        $$

    4. **有 $k$ 对重复根**：设特征根为 $r_1 = \alpha + \beta i$，$r_2 = \alpha - \beta i$，则有

        $$
        y(x) = e^{\alpha x} (C_1 \cos(\beta x) + C_2 \sin(\beta x)) + C_3 e^{\alpha x} x \cos(\beta x) + C_4 e^{\alpha x} x \sin(\beta x) + \cdots
        $$

## 二阶常系数非齐次线性微分方程
我们已经介绍了常系数齐次线性微分方程的求解方法，针对非齐次方程，只需求出一个特解 $y_p(x)$，然后加上齐次方程的通解 $y_h(x)$ 即可。

一般情况来说，非齐次线性微分方程的特解不是那么容易通过观察法确定的，针对下面的二阶常系数非齐次线性微分方程

$$
y'' + a_1 y' + a_2 y = f(x)
$$

如果 $f(x)$ 是形式如 $P_m(x) e^{\lambda x}$ 或 $e^{\lambda x} [P_l(x) \cos\omega x + P_n(x) \sin\omega x]$ 或它们的线性组合的函数，我们可以使用待定系数法来求解特解。

### $f(x) = P_m(x) e^{\lambda x}$ 的情况

对于 $f(x) = P_m(x) e^{\lambda x}$ （其中 $P_m$ 是 $m$ 次多项式），我们可以设特解为

$$
y^* = Q(x) e^{\lambda x}
$$

那么就有

$$
{y^*}' = \left( Q'(x) + \lambda Q(x) \right) e^{\lambda x}
$$

$$
{y^*}'' = \left( Q''(x) + 2\lambda Q'(x) + \lambda^2 Q(x) \right) e^{\lambda x}
$$

于是将特解代入原方程，消去 $e^{\lambda x}$ 得到

$$
Q''(x) + 2\lambda Q'(x) + \lambda^2 Q(x) + a_1 \left( Q'(x) + \lambda Q(x) \right) + a_2 Q(x) = P_m(x)
$$

整理得到

$$
Q''(x) + (2\lambda + a_1) Q'(x) + (\lambda^2 + a_1 \lambda + a_2) Q(x) = P_m(x)
$$

分情况讨论，如果 $\lambda^2 + a_1 \lambda + a_2$ 和 $2\lambda + a_1$ 不为 $0$，那么可以设 $Q(x)$ 为某个形式的多项式。

$$
Q(x) = A_m x^m + A_{m-1} x^{m-1} + \cdots + A_0
$$

将其带入原方程，比较同次项系数，得到 $A_m, A_{m-1}, \cdots, A_0$ 的值，即可解出一个特解。

如果 $\lambda^2 + a_1 \lambda + a_2 = 0$，且 $2\lambda + a_1 \neq 0$，那么 $\lambda$ 是二次方程的单根，$Q'(x)$ 是 $m$ 次多项式，我们可以设 $Q(x)$ 为

$$
Q(x) = x(A_m x^m + A_{m-1} x^{m-1} + \cdots + A_0)
$$

将其带入原方程，同理。

如果 $\lambda^2 + a_1 \lambda + a_2 = 0$，且 $2\lambda + a_1 = 0$，那么 $\lambda$ 是二次方程的重根，$Q''(x)$ 是 $m$ 次多项式，我们可以设 $Q(x)$ 为

$$
Q(x) = x^2(A_m x^m + A_{m-1} x^{m-1} + \cdots + A_0)
$$

总而言之，这种情况下，特解的形式为 $y^* = x^kQ_m(x) e^{\lambda x}$

### $f(x) = e^{\lambda x} [P_l(x) \cos\omega x + P_n(x) \sin\omega x]$ 的情况

有了上面的经验，我们可以将三角函数化为复数形式，有

$$
f(x) = e^{\lambda x} [P_l(x) \frac{e^{i \omega x} + e^{-i \omega x}}{2} + P_n(x) \frac{e^{i \omega x} - e^{-i \omega x}}{2i}]
$$

然后针对该形式，重复上面模块的步骤，最终得到的特解形式为

$$
y^* = x^k e^{\lambda x} [R_m^{(1)}(x) \cos(\omega x) + R_m^{(2)}(x) \sin(\omega x)]
$$